<script type="module">
	// 从Flask模板接收数据并初始化应用程序
	// 使用动态import以支持Jinja2模板变量
	(async function() {
		// 从Flask模板获取变量
		const config = {
			step: {{ step|tojson }},
			secPerStep: {{ sec_per_step|tojson }},
			zoom: {{ zoom|tojson }},
			playSpeed: {{ play_speed|tojson }},
			allMovement: {{ all_movement|tojson }},
			startDatetime: {{ start_datetime|tojson }},
			agentLogs: {{ agent_logs|tojson }} || {},
			personaInitPos: {{ persona_init_pos|tojson }}
		};

		// 动态导入主模块
		const { initApp } = await import("{{ url_for('static', filename='js/main.js') }}");
		
		// 初始化应用程序
		initApp(config);
	})();
</script>
